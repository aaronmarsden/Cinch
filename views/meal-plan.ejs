<% include partials/header %>

<div class="outside__container">
    <div class="header__text non_print">
            <h1>Your <%=diet%>, <%= calories %>-calorie meal plan.</h1>
            <p>I like the way you live. Below you'll find your <%= calories %>-calorie, <%= meal %> meal plan. Hover over the items to see their nutrition data, recipes, and dead-simple preparation instructions.</strong></p>
    </div>
    <div class="header__advanced__content non_print">
            <p class="redoRecipes non_print"><a href="/" style="text-decoration:none; color:#e9342c;">Want to try a different diet? Click here!</a></p>
            <div class="food__grid non_print">
                <div class="calorieCount">
                    <p><strong>Total calories: <span class="total__calories__span"><%=totalCalories%></span></strong></p>
                    <i class="fa fa-sync-alt fa-lg refresh"></i>
                </div>
                <div class="food__grid__items">
                    <div class="food__breakfast">
                        <p class="meal__name"><strong>Breakfast</strong></p>
                        <p class="meal__calories">Calories: <span class="breakfastCalSpan"><%=breakfastCalories%></span></p>
                        <div class = "breakfast__items__container">
                        <% breakfastArr.forEach(function(breakfast) { %>
                           <div class="food__grid__item tooltip">
                                <div class="tooltiptext">
                                    <p class="tooltip__name"><%=breakfast.name%></p>
                                    <p class="cook__time">Cook time: <%=breakfast.time_to_make%></p>
                                    <hr>
                                    <p class="tooltip__nutrition">Nutrition info: </p>
                                    <ul class="tooltip__nutrition__list">
                                        <li class="tooltip__nutrition__list__item item1"><span>Calories:</span> <span class="currentCal"><%=breakfast.nutrition.calories%></span></li>
                                        <li class="tooltip__nutrition__list__item"><span>Carbs:</span> <%=breakfast.nutrition.carbs%>g</li>
                                        <li class="tooltip__nutrition__list__item"><span>Fat:</span> <%=breakfast.nutrition.fat%>g</li>
                                        <li class="tooltip__nutrition__list__item"><span>Protein:</span> <%=breakfast.nutrition.protein%>g</li>
                                    </ul>
                                    <hr>
                                    <p class="tooltip__nutrition">Ingredients: </p>
                                    <ul class="tooltip__ingredient__list">
                                        <li class="tooltip__ingredient__list__item"><%=breakfast.ingredients.one.amount%> <%=breakfast.ingredients.one.unit%> <%=breakfast.ingredients.one.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=breakfast.ingredients.two.amount%> <%=breakfast.ingredients.two.unit%> <%=breakfast.ingredients.two.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=breakfast.ingredients.three.amount%> <%=breakfast.ingredients.three.unit%> <%=breakfast.ingredients.three.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=breakfast.ingredients.four.amount%> <%=breakfast.ingredients.four.unit%> <%=breakfast.ingredients.four.name%></li>
                                    </ul>
                                </div>
                                
                                <div id="myModalBreakfast" class="modalBreakfast">

                                  <!-- Modal content -->
                                <div class="modal-content">
                                    <div class="modal-header">
                                      <span class="closeBreakfast">&times;</span>
                                      <div class="modal-header-flex">
                                        <h2><%=breakfast.name%></h2>
                                        <div class="modal-header-information">
                                            <p>Time to cook: <%= breakfast.time_to_make %></p>
                                            <p>Servings: <%= breakfast.nutrition.serving_size %></p> 
                                        </div>
                                      </div>
                                    </div>
                                    <div class="modal-body">
                                      <div class="modal-body-ingredients">
                                        <p>Ingredients:</p>
                                        <div class="modal__ingredient__list__container">
                                        <% var breakIngObj = breakfast.ingredients; %>
                                        <% Object.keys(breakIngObj).forEach(function(key) { %>
                                            <% var ingKey = breakIngObj[key]; %>
                                            <% var ingKeyName = ingKey.name; %>
                                            <% if (ingKeyName !== undefined) { %>
                                              <div class="food__grid__item">
                                                <div class="food__item__image">
                                                    <img class="food__image" src="<%=ingKey.image%>">
                                                </div>
                                                <div class="food__item__info">
                                                    <p class="tooltip__name"><%=ingKey.name%></p>
                                                    <p class="food__info"><%=ingKey.amount%> <%=ingKey.unit%></p>
                                                </div>
                                              </div>
                                            <% } %>
                                        <% }) %>
                                        </div>
                                      </div>
                                      <div class="modal-body-nutrition">
                                          <p>Nutrition:</p>
                                          <div class="modal__nutrition">
                                            <div>
                                                <ul class="modal__nutrition__list">
                                                    <li class="tooltip__nutrition__list__item"><span>Calories:</span> <%=breakfast.nutrition.calories%></li>
                                                    <li class="tooltip__nutrition__list__item"><span>Carbs:</span> <%=breakfast.nutrition.carbs%>g</li>
                                                    <li class="tooltip__nutrition__list__item"><span>Fat:</span> <%=breakfast.nutrition.fat%>g</li>
                                                    <li class="tooltip__nutrition__list__item"><span>Protein:</span> <%=breakfast.nutrition.protein%>g</li>
                                                </ul>
                                                <ul class="modal__nutrition__list">
                                                    <li><span>Fiber:</span> <%=breakfast.nutrition.fiber%>g</li>
                                                    <li><span>Sodium:</span> <%=breakfast.nutrition.sodium%>mg</li>
                                                    <li><span>Cholesterol:</span> <%=breakfast.nutrition.cholesterol%>mg</li>
                                                    <li><span>Sugar:</span> <%=breakfast.nutrition.sugar%>g</li>
                                                </ul>
                                            </div>
                                          </div>
                                      </div>
                                    </div>
                                    <div class="modal__instructions">
                                        <p class="modal__instructions__header">Instructions:</p>
                                        <p class="modal__instructions__instructions"><%=breakfast.instructions%></p>
                                    </div>
                                  </div>
                                
                                </div>
                                
                                <div class="food__item__image">
                                    <img class="food__image" src="<%=breakfast.image%>">
                                </div>
                                <div class="food__item__info">
                                    <p class="breakfast__name"><%=breakfast.name%></p>
                                    <p class="food__info">Servings: <%= breakfast.nutrition.serving_size %></p>
                                </div>
                                <div class="myBtn">
                                    <div class="refreshContainer">
                                       <i class="fa fa-sync-alt fa-lg myRefreshButtonBreakfast"></i> 
                                    </div>
                                    <i class="fa fa-info-circle fa-lg myBtnBtnBreakfast"></i>
                                </div>
                            </div> 
                        <% }) %>
                        </div>
                    </div>
                    <div class="food__lunch">
                        <p class="meal__name"><strong>Lunch</strong></p>
                        <p class="meal__calories">Calories: <span class="lunchCalSpan"><%=lunchCalories%></span></p>
                        <div class = "lunch__items__container">
                        <% var random = Math.floor(Math.random() * 30); %>
                        <% var newFoodItem = extraLunchArr[random]; %>
                        <% lunchArr.forEach(function(lunch) { %>
                           <div class="food__grid__item tooltip">
                                <div class="tooltiptext">
                                    <p class="tooltip__name"><%=lunch.name%></p>
                                    <p class="cook__time">Cook time: <%=lunch.time_to_make%></p>
                                    <hr>
                                    <p class="tooltip__nutrition">Nutrition info: </p>
                                    <ul class="tooltip__nutrition__list">
                                        <li class="tooltip__nutrition__list__item item1"><span>Calories:</span> <span class="currentCal"><%=lunch.nutrition.calories%></span></li>
                                        <li class="tooltip__nutrition__list__item"><span>Carbs:</span> <%=lunch.nutrition.carbs%>g</li>
                                        <li class="tooltip__nutrition__list__item"><span>Fat:</span> <%=lunch.nutrition.fat%>g</li>
                                        <li class="tooltip__nutrition__list__item"><span>Protein:</span> <%=lunch.nutrition.protein%>g</li>
                                    </ul>
                                    <hr>
                                    <p class="tooltip__nutrition">Ingredients: </p>
                                    <ul class="tooltip__ingredient__list">
                                        <li class="tooltip__ingredient__list__item"><%=lunch.ingredients.one.amount%> <%=lunch.ingredients.one.unit%> <%=lunch.ingredients.one.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=lunch.ingredients.two.amount%> <%=lunch.ingredients.two.unit%> <%=lunch.ingredients.two.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=lunch.ingredients.three.amount%> <%=lunch.ingredients.three.unit%> <%=lunch.ingredients.three.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=lunch.ingredients.four.amount%> <%=lunch.ingredients.four.unit%> <%=lunch.ingredients.four.name%></li>
                                    </ul>
                                </div>
                                
                                <div id="myModalLunch" class="modalLunch">

                                  <!-- Modal content -->
                                <div class="modal-content">
                                    <div class="modal-header">
                                      <span class="closeLunch">&times;</span>
                                      <div class="modal-header-flex">
                                        <h2><%=lunch.name%></h2>
                                        <div class="modal-header-information">
                                            <p>Time to cook: <%= lunch.time_to_make %></p>
                                            <p>Servings: <%= lunch.nutrition.serving_size %></p> 
                                        </div>
                                      </div>
                                    </div>
                                    <div class="modal-body">
                                      <div class="modal-body-ingredients">
                                        <p>Ingredients:</p>
                                        <div class="modal__ingredient__list__container">
                                        <% var lunchIngObj = lunch.ingredients; %>
                                        <% Object.keys(lunchIngObj).forEach(function(key) { %>
                                            <% var ingKey = lunchIngObj[key]; %>
                                            <% var ingKeyName = ingKey.name; %>
                                            <% if (ingKeyName !== undefined) { %>
                                              <div class="food__grid__item">
                                                <div class="food__item__image">
                                                    <img class="food__image" src="<%=ingKey.image%>">
                                                </div>
                                                <div class="food__item__info">
                                                    <p class="tooltip__name"><%=ingKey.name%></p>
                                                    <p class="food__info"><%=ingKey.amount%> <%=ingKey.unit%></p>
                                                </div>
                                              </div>
                                            <% } %>
                                        <% }) %>
                                        </div>
                                      </div>
                                      <div class="modal-body-nutrition">
                                          <p>Nutrition:</p>
                                          <div class="modal__nutrition">
                                            <div>
                                                <ul class="modal__nutrition__list">
                                                    <li class="tooltip__nutrition__list__item"><span>Calories:</span> <%=lunch.nutrition.calories%></li>
                                                    <li class="tooltip__nutrition__list__item"><span>Carbs:</span> <%=lunch.nutrition.carbs%>g</li>
                                                    <li class="tooltip__nutrition__list__item"><span>Fat:</span> <%=lunch.nutrition.fat%>g</li>
                                                    <li class="tooltip__nutrition__list__item"><span>Protein:</span> <%=lunch.nutrition.protein%>g</li>
                                                </ul>
                                                <ul class="modal__nutrition__list">
                                                    <li><span>Fiber:</span> <%=lunch.nutrition.fiber%>g</li>
                                                    <li><span>Sodium:</span> <%=lunch.nutrition.sodium%>mg</li>
                                                    <li><span>Cholesterol:</span> <%=lunch.nutrition.cholesterol%>mg</li>
                                                    <li><span>Sugar:</span> <%=lunch.nutrition.sugar%>g</li>
                                                </ul>
                                            </div>
                                          </div>
                                      </div>
                                    </div>
                                    <div class="modal__instructions">
                                        <p class="modal__instructions__header">Instructions:</p>
                                        <p class="modal__instructions__instructions"><%=lunch.instructions%></p>
                                    </div>
                                  </div>
                                
                                </div>
                                
                                <div class="food__item__image">
                                    <img class="food__image" src="<%=lunch.image%>">
                                </div>
                                <div class="food__item__info">
                                    <p class="lunch__name"><%=lunch.name%></p>
                                    <p class="food__info">Servings: <%= lunch.nutrition.serving_size %></p>
                                </div>
                                <div class="myBtn">
                                    <div class="refreshContainer">
                                        <i class="fa fa-sync-alt fa-lg myRefreshButtonLunch"></i> 
                                    </div>
                                    <i class="fa fa-info-circle fa-lg myBtnBtnLunch"></i>
                                </div>
                            </div> 
                        <% }) %>
                        </div>
                    </div>
                    <div class="food__dinner">
                        <p class="meal__name"><strong>Dinner</strong></p>
                        <p class="meal__calories">Calories: <span class="dinnerCalSpan"><%=dinnerCalories%></span></p>
                        <div class = "dinner__items__container">
                        <% dinnerArr.forEach(function(dinner) { %>
                           <div class="food__grid__item tooltip">
                                <div class="tooltiptext">
                                    <p class="tooltip__name"><%=dinner.name%></p>
                                    <p class="cook__time">Cook time: <%=dinner.time_to_make%></p>
                                    <hr>
                                    <p class="tooltip__nutrition">Nutrition info: </p>
                                    <ul class="tooltip__nutrition__list">
                                        <li class="tooltip__nutrition__list__item item1"><span>Calories:</span> <span class="currentCal"><%=dinner.nutrition.calories%></span></li>
                                        <li class="tooltip__nutrition__list__item"><span>Carbs:</span> <%=dinner.nutrition.carbs%>g</li>
                                        <li class="tooltip__nutrition__list__item"><span>Fat:</span> <%=dinner.nutrition.fat%>g</li>
                                        <li class="tooltip__nutrition__list__item"><span>Protein:</span> <%=dinner.nutrition.protein%>g</li>
                                    </ul>
                                    <hr>
                                    <p class="tooltip__nutrition">Ingredients: </p>
                                    <ul class="tooltip__ingredient__list">
                                        <li class="tooltip__ingredient__list__item"><%=dinner.ingredients.one.amount%> <%=dinner.ingredients.one.unit%> <%=dinner.ingredients.one.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=dinner.ingredients.two.amount%> <%=dinner.ingredients.two.unit%> <%=dinner.ingredients.two.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=dinner.ingredients.three.amount%> <%=dinner.ingredients.three.unit%> <%=dinner.ingredients.three.name%></li>
                                        <li class="tooltip__ingredient__list__item"><%=dinner.ingredients.four.amount%> <%=dinner.ingredients.four.unit%> <%=dinner.ingredients.four.name%></li>
                                    </ul>
                                </div>
                                
                                <div id="myModalDinner" class="modalDinner">

                                  <!-- Modal content -->
                                <div class="modal-content">
                                    <div class="modal-header">
                                      <span class="closeDinner">&times;</span>
                                      <div class="modal-header-flex">
                                        <h2><%=dinner.name%></h2>
                                        <div class="modal-header-information">
                                            <p>Time to cook: <%= dinner.time_to_make %></p>
                                            <p>Servings: <%= dinner.nutrition.serving_size %></p> 
                                        </div>
                                      </div>
                                    </div>
                                    <div class="modal-body">
                                      <div class="modal-body-ingredients">
                                        <p>Ingredients:</p>
                                        <div class="modal__ingredient__list__container">
                                        <% var dinnerIngObj = dinner.ingredients; %>
                                        <% Object.keys(dinnerIngObj).forEach(function(key) { %>
                                            <% var ingKey = dinnerIngObj[key]; %>
                                            <% var ingKeyName = ingKey.name; %>
                                            <% if (ingKeyName !== undefined) { %>
                                              <div class="food__grid__item">
                                                <div class="food__item__image">
                                                    <img class="food__image" src="<%=ingKey.image%>">
                                                </div>
                                                <div class="food__item__info">
                                                    <p class="tooltip__name"><%=ingKey.name%></p>
                                                    <p class="food__info"><%=ingKey.amount%> <%=ingKey.unit%></p>
                                                </div>
                                              </div>
                                            <% } %>
                                        <% }) %>
                                        </div>
                                      </div>
                                      <div class="modal-body-nutrition">
                                          <p>Nutrition:</p>
                                          <div class="modal__nutrition">
                                            <div>
                                                <ul class="modal__nutrition__list">
                                                    <li class="tooltip__nutrition__list__item"><span>Calories:</span> <%=dinner.nutrition.calories%></li>
                                                    <li class="tooltip__nutrition__list__item"><span>Carbs:</span> <%=dinner.nutrition.carbs%>g</li>
                                                    <li class="tooltip__nutrition__list__item"><span>Fat:</span> <%=dinner.nutrition.fat%>g</li>
                                                    <li class="tooltip__nutrition__list__item"><span>Protein:</span> <%=dinner.nutrition.protein%>g</li>
                                                </ul>
                                                <ul class="modal__nutrition__list">
                                                    <li><span>Fiber:</span> <%=dinner.nutrition.fiber%>g</li>
                                                    <li><span>Sodium:</span> <%=dinner.nutrition.sodium%>mg</li>
                                                    <li><span>Cholesterol:</span> <%=dinner.nutrition.cholesterol%>mg</li>
                                                    <li><span>Sugar:</span> <%=dinner.nutrition.sugar%>g</li>
                                                </ul>
                                            </div>
                                          </div>
                                      </div>
                                    </div>
                                    <div class="modal__instructions">
                                        <p class="modal__instructions__header">Instructions:</p>
                                        <p class="modal__instructions__instructions"><%=dinner.instructions%></p>
                                    </div>
                                  </div>
                                </div>
                                
                                <div class="food__item__image">
                                    <img class="food__image" src="<%=dinner.image%>">
                                </div>
                                <div class="food__item__info">
                                    <p class="dinner__name"><%=dinner.name%></p>
                                    <p class="food__info">Servings: <%= dinner.nutrition.serving_size %></p>
                                </div>
                                    <div class="myBtn">
                                        <div class="refreshContainer">
                                            <i class="fa fa-sync-alt fa-lg myRefreshButtonDinner"></i> 
                                        </div>
                                        <i class="fa fa-info-circle fa-lg myBtnBtnDinner"></i>
                                    </div>
                            </div> 
                        <% }) %>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="mySaveModal" class="modalSave">

              <!-- Modal content -->
            <div class="modal-content-save">
                <div class="modal-header">
                  <span class="closeSave">&times;</span>
                  <div>
                    <h2>Save Meal Plan</h2>
                  </div>
                </div>
                <div class="modal-body-save">
                  <h2>Name your plan:</h3>
                  <input type="text" class="saveInput" placeholder="Meal plan name">
                  <br>
                  <button class="savePlanModal">Save Meal Plan</button>
                </div>
              </div>
            </div>
            
            <div class="bottomButtons">
                <form name="afx-ingredients-verifier-form" method="post" action="https://www.amazon.com/afx/ingredients/landing?tag=simplemeals-20" autocomplete="off" class="default-center" target="_blank">
                    <input class="amazonInput" type="hidden" name="ingredients" id="afx-ingredients-verified-hidden-input" value=''>
                    <span class="a-button a-spacing-base a-button-base fresh-green-button" id="a-autoid-1"><span class="a-button-inner">
                        <button class="amazonButton" type="submit">Buy All Ingredients on AmazonFresh</button>
                    </span>
                    </span>
                </form>
                <% if (currentUser) { %>
                    <button class="savePlan non_print">Save</button>
                <% } %>
                <button class="printButton non_print">Print</button>
            </div>
            <% if (!currentUser) { %>
            
                <p><a href="/login">Log in</a> or <a href="/signup">create an account</a> to save meal plans to profile.</p>
            
            <% } %>
            
    </div>
</div>


<!--SCRIPTS-->

<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
<script src="sweetalert2.all.min.js"></script>
<!-- Optional: include a polyfill for ES6 Promises for IE11 and Android browser -->
<script src="https://cdn.jsdelivr.net/npm/promise-polyfill"></script>

<script>
  var breakfastArr = <%- JSON.stringify(breakfastArr) %>;
  var lunchArr = <%- JSON.stringify(lunchArr) %>;
  var dinnerArr = <%- JSON.stringify(dinnerArr) %>;
  var ingredientList = <%- JSON.stringify(ingredientList) %>;
  var extraBreakfastArr = <%- JSON.stringify(extraBreakfastArr) %>;
  var extraLunchArr = <%- JSON.stringify(extraLunchArr) %>;
  var extraDinnerArr = <%- JSON.stringify(extraDinnerArr) %>;
  var breakfastCalories = <%- JSON.stringify(breakfastCalories) %>;
  var lunchCalories = <%- JSON.stringify(lunchCalories) %>;
  var dinnerCalories = <%- JSON.stringify(dinnerCalories) %>;
  var diet = <%- JSON.stringify(diet) %>;
</script>

<script src="/js/home.js"></script>


<% include partials/footer %>